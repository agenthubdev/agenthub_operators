# WebSearch

**WebSearch** is a class that inherits from `BaseOperator`. The main functionality of this class is to perform a web search using the Google Custom Search API and return the search results to be used by other operators in a pipeline. The search query is generated by running an AI chat completion with a given prompt.

The class has the following key methods:

- **declare_name** : Returns the string 'Web search'
- **declare_category** : Returns the category 'CONSUME_DATA'
- **declare_parameters** : Returns a list of parameters, including `query` (string) and `results_count` (integer)
- **declare_inputs** : Returns an empty list
- **declare_outputs** : Returns a list with the output `search_results`, containing the name (URL) and content (snippet) of the search results
- **run_step** : Generates a prompt and runs an AI chat completion, then it performs a Google search and returns the URLs and snippets of the search results
- **get_urls_and_snippets** : Extracts the URLs and snippets from the Google search response
- **gen_prompt** : Generates the prompt to be used in the AI chat completion
- **google_search** : Performs the actual Google search using the API and returns the search results
- **to_utf8_json_list** : Converts a list of strings to a JSON list with UTF-8 encoding


The `WebSearch` class is designed to work together with other operators in a pipeline:

1. It takes **inputs** and **parameters**:
    - **query** (string): The search query, which can be provided either as an input or as a parameter
    - **results_count** (integer): The number of search results to return

2. It generates **outputs**:
    - **search_results** (type: `{name, content}[]`): A list of search results containing the URL (name) and snippet (content).

3. The helper methods perform the following tasks:
    - **get_urls_and_snippets**: Extracts the URLs and snippets from the Google search response.
    - **gen_prompt**: Generates the prompt to be passed to AI chat completion.
    - **google_search**: Performs a Google search via the Custom Search API.

To use the `WebSearch` class, simply create an instance, and call the `run_step()` method. The AI chat completion will generate a search query, the Google search will be performed, and the URLs and snippets of the search results will be stored in the output.